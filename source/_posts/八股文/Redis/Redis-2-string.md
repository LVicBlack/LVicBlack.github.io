---
title: Redis - 2.string
date: 2020-08-16 17:52:03
categories: 
- 八股文
- Redis
tags:
- Redis
- 面试
---

### **string 4**

#### **Q1：简单说一说 string 类型**

字符串类型是 Redis 最基础的数据结构，键都是字符串类型，而且其他几种数据结构都是在字符串类型的基础上构建的。字符串类型的值可以实际可以是字符串（简单的字符串、复杂的字符串如 JSON、XML）、数字（整形、浮点数）、甚至二进制（图片、音频、视频），但是值最大不能超过 512 MB。

---

#### **Q2：你知道哪些 string 的命令？**

**设置值**

set key value \[ex seconds\] \[px millseconds\] \[nx|xx\]

* ex seconds：为键设置秒级过期时间，跟 setex 效果一样
* px millseconds：为键设置毫秒级过期时间
* nx：键必须不存在才可以设置成功，用于添加，跟 setnx 效果一样。由于 Redis 的单线程命令处理机制，如果多个客户端同时执行，则只有一个客户端能设置成功，可以用作分布式锁的一种实现。
* xx：键必须存在才可以设置成功，用于更新

**获取值**

get key，如果不存在返回 nil

**批量设置值**

mset key value \[key value...\]

**批量获取值**

mget key \[key...\]

批量操作命令可以有效提高开发效率，假如没有 mget，执行 n 次 get 命令需要 n 次网络时间 \+ n 次命令时间，使用 mget 只需要 1 次网络时间 \+ n 次命令时间。Redis 可以支持每秒数万的读写操作，但这指的是 Redis 服务端的处理能力，对于客户端来说一次命令处理命令时间还有网络时间。因为 Redis 的处理能力已足够高，对于开发者来说，网络可能会成为性能瓶颈。

**计数**

incr key

incr 命令用于对值做自增操作，返回结果分为三种：

① 值不是整数返回错误。

② 值是整数，返回自增后的结果。

③ 值不存在，按照值为 0 自增，返回结果 1。除了 incr 命令，还有自减 decr、自增指定数字 incrby、自减指定数组 decrby、自增浮点数 incrbyfloat。

---

#### **Q3：string 的内部编码是什么？**

* int：8 个字节的长整形
* embstr：小于等于 39 个字节的字符串
* raw：大于 39 个字节的字符串

---

#### **Q4：string 的应用场景有什么？**

**缓存功能**

Redis 作为缓存层，MySQL 作为存储层，首先从 Redis 获取数据，如果失败就从 MySQL 获取并将结果写回 Redis 并添加过期时间。

**计数**

Redis 可以实现快速计数功能，例如视频每播放一次就用 incy 把播放数加 1。

**共享 Session**

一个分布式 Web 服务将用户的 Session 信息保存在各自服务器，但会造成一个问题，出于负载均衡的考虑，分布式服务会将用户的访问负载到不同服务器上，用户刷新一次可能会发现需要重新登陆。为解决该问题，可以使用 Redis 将用户的 Session 进行集中管理，在这种模式下只要保证 Redis 是高可用和扩展性的，每次用户更新或查询登录信息都直接从 Redis 集中获取。

**限速**

例如为了短信接口不被频繁访问会限制用户每分钟获取验证码的次数或者网站限制一个 IP 地址不能在一秒内访问超过 n 次。可以使用键过期策略和自增计数实现。
